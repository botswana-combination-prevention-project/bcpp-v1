{% extends "section_result.html" %}

{% block section_title%}<h1>Results Details for Result {{ result.result_identifier }}</h1>{% endblock%}

{% block section_links %}
<!--
 <form action="." method="POST">
	<div style='display:none'>  
      {% csrf_token %}
    </div>
    <table>
    <tr>
    <td class="field">
        {{ form.search_term.errors }}
        <label for="id_result_search_term"></label>
        <input type="text" class="default" name="result_search_term" />
        {{ form.search_term }}
    </td>
    <td>
        <input type="submit" value="Search" class="default" name="search" />
    </td>
    
    <script type="text/javascript">document.getElementById("id_result_search_term").focus();</script>
    <script type="text/javascript">
        (function($) {
            var field = null;
        })(django.jQuery);
    </script>
        </table>
    </form>
    -->
 {% endblock %}


{% block top_search_name %}
        {% if search_results.object_list %}
            <h3>Most recent (top) {{ search_results.object_list.count }} {{search_name|capfirst}}{{ search_results.object_list|pluralize }}</h3>
            <i><small>Showing top {{ search_results.object_list.count }} result{{ search_results.object_list|pluralize }} only. Use search to see more.</small></i>
            {% include top_result_include_file %}
        {% endif %}
          
{% endblock top_search_name  %}


{% block search_results %}
if searching
    {% if search_results %}
    <div class="">
    <table>
    <thead><th align=left><B>Utestid</B></th>
    <th align=left ><B>Description</B></th>
    <th align=left ><B>assay date</B></th>
    <th align=right ><B>Result</B></th>
    <th align=center ><B>Units</B></th>
    <th align=center ><B>Reference</B></th>
    <th align=center "><B>Flag</B></th>
    </thead>
    <tbody>
    {% for row in results %}
        <tr>
        <td>{{ row.utestid }} </td>
        <td>{{ row.utestid_description }} </td>
        <td>{{ row.assay_date }} </td>
        <td>{{ row.result }} </td>
        <td>{{ row.units }} </td>
        <td>{{ row.reference_range }} </td>
        <td>{{ row.reference_range_flag }} {{ row.grading_flag }} </td>
        </tr>           
    {% endfor %}    
    </tbody>
    </table>
    </div>
    {% endif %}
{% endblock search_results %}

{% block result %}
    {% if result %}
      {%  include result_include_file %} 
<table bgcolor="LightYellow">
    <thead><th colspan="4">Options:</th></thead>
    <tr>
       <td>
            <form method="GET" action="/bhp_lab_result_report/result/print_pdf/{{ result.result_identifier|escape}}/">
                <input type="submit" value="Print" class="default" />
            </form>
        </td>
        
        <td>
            <form method="GET" action="/bhp_lab_result_report/result/email/{{ result.result_identifier|escape}}/">
                <input type="submit" value="Email" class="default" />
            </form>
        </td>

        <td>
            <form method="GET" action="/admin/bhp_lab_core/result/{{ result.id }}">
                <input type="submit" value="Edit" class="default" />
            </form>
        </td>
                        
    </tr>
    </table>        
         
        {%  include receiving_include_file %}
        
        {%  include orders_include_file %}
        
        {%  include result_items_include_file %}
        
        <div><h2>Validation Information</h2>
        <table>
        <tr>
        <td width=50% valign="top">
            <table>
            <tr><td >Comment: {{ sample_comment }}. {% for key,warning in result_warnings.items %}&nbsp;{{ i|upper }}&nbsp;{% endfor %}
            <tr><td >Condition code:  {{ sample_condition }} {{ sample_condition_description }}</td></tr>
            </table>
        </td>
        <td valign="top">
            <table>
            <tr><td>Authorised and released by:</td></tr>
            <tr><td >Operator:  {{validation_ref_summary.operator}}</td></tr>
            <tr><td >Validated by:  {{validation_ref_summary.validator}}</td></tr>
            <tr><td >Validated on:  {{validation_ref_summary.date_validated|date:"Y-m-d" }} {{ validation_ref_summary.date_validated|date:'Y-m-d' }}</td></tr>
            <tr><td >Method:  {{ validation_ref_summary.validation_method_ref }}</td></tr>
            </td>
            </tr>
            </table>
        </td>
        </tr>
        </table>
      </div>
    {% endif %}
{% endblock %}


